<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Employees</title>
    <link rel="stylesheet" href="styles/styles.css">
</head>
<body>

<p>Tables</p>
<div id="tables"></div>
<p>Data</p>
<div id="tableDataSection">
    <div id="titleWithButtonSection">
        <span class="label"></span>
        <button class="add">+</button>
    </div>
    <table></table>
</div>

<script>
    app = {};
</script>

<script src="services/databaseDataServcie.js"></script>
<script src="services/tableDataService.js"></script>
<script src="utils/table.js"></script>

<script>
    app.databaseDataService.getTables(function(tablesJson){
        var tableNames = JSON.parse(tablesJson);
        app.utils.table.create(tableNames, "Tables", document.getElementById("tables"));

        createClickCallbacks();
    })

    function createClickCallbacks(){
        var table = document.querySelector('#tables>table');

        table.onclick = function(event){
            if(event.target.nodeName=="TD"){
                var tableName = event.target.textContent;
                showData(tableName);
            }
        };
    }

    var tableDataSection = document.getElementById("tableDataSection");
    var tableLabel = tableDataSection.querySelector(".label");

    function showData(tableName){
        app.tableDataService.getTableData(tableName, function(tableDataJson){
            var tableData = JSON.parse(tableDataJson);


            var curTable = tableDataSection.querySelector("table");
            app.utils.table.update(tableData.data, tableData.columnNames, tableDataSection, curTable);
            tableLabel.innerText = tableName;
            tableDataSection.style.visibility="visible";
        })
    }



</script>

</body>
</html>